<div>
	<nz-breadcrumb class="font-bold text-sm text-white" [nzAutoGenerate]="true"> </nz-breadcrumb>
</div>
<div class="container mx-auto py-6">
	<div class="flex flex-col md:flex-row justify-between items-center mb-6">
		<h1 class="text-xl font-semibold text-gray-800 mb-4 md:mb-0 flex items-center">
			<i nz-icon nzType="tag" nzTheme="outline" class="text-2xl mr-2"></i>

			Gesti贸n de Personas
		</h1>

		<div class="flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-4">
			<nz-input-group [nzSuffix]="suffixIconSearch" class="w-full md:w-64">
				<input type="text" nz-input placeholder="Buscar persona" [(ngModel)]="search" (keyup.enter)="searchTo()" />
			</nz-input-group>
			<ng-template #suffixIconSearch>
				<span nz-icon nzType="search"></span>
			</ng-template>
			<div class="flex">
				<button
					(click)="refreshPage()"
					nz-tooltip
					nzTooltipTitle="Refrescar"
					class="flex items-center justify-center h-9 px-3 bg-[#22c55e] hover:bg-[#1ea352] transition-colors"
				>
					<span nz-icon nzType="sync" nzTheme="outline" class="text-white text-lg font-bold"></span>
				</button>

				<button
					routerLink="../crear-personas"
					class="flex items-center justify-center h-9 px-4 bg-[#6366f1] hover:bg-[#5558e4] transition-colors"
				>
					<span nz-icon nzType="plus-circle" nzTheme="fill" class="text-white text-lg font-bold mr-2"></span>
					<span class="text-white font-medium">Crear</span>
				</button>
			</div>
		</div>
	</div>

	<nz-table
		#basicTable
		[nzData]="personas"
		[nzLoading]="loading"
		[nzPageSize]="limit"
		[nzTotal]="total"
		[nzFrontPagination]="false"
		(nzPageIndexChange)="onPageChange($event)"
		nzShowSizeChanger
		[nzBordered]="true"
		[nzShowQuickJumper]="true"
	>
		<thead>
			<tr class="bg-gray-100">
				<th class="font-semibold text-gray-700">Datos Personales</th>
				<th class="font-semibold text-gray-700">Documento</th>
				<th class="font-semibold text-gray-700">Contacto</th>
				<th class="font-semibold text-gray-700">Ubicaci贸n</th>
				<th class="font-semibold text-gray-700">Acciones</th>
			</tr>
		</thead>
		<tbody>
			@for (persona of basicTable.data; track persona.id_persona) {
				<tr class="hover:bg-gray-50">
					<td class="font-medium text-gray-800">
						<div>{{ persona.nombres }} {{ persona.apellido_paterno }} {{ persona.apellido_materno }}</div>
						<small class="text-gray-500">
							@if (persona.razon_social) {
								Raz贸n Social: {{ persona.razon_social }}
							}
						</small>
					</td>
					<td>
						<div>{{ persona.tb_tipo_documento.documento }}: {{ persona.numero_documento }}</div>
						<div class="text-xs text-gray-500">
							@if (persona.estado_documento) {
								Estado: {{ persona.estado_documento }}
								<br />
								Condici贸n: {{ persona.condicion_documento }}
							}
						</div>
					</td>
					<td>
						<div>
							@if (persona.correo) {
								<div><i nz-icon nzType="mail"></i> {{ persona.correo }}</div>
							}
							@if (persona.tb_telefonos_persona.length) {
								<div><i nz-icon nzType="phone"></i> {{ persona.tb_telefonos_persona[0].numero_telefono }}</div>
							}
						</div>
					</td>
					<td>
						<div>{{ persona.tb_pais.nombre }}</div>
						@if (persona.departamento) {
							<small class="text-gray-500">
								{{ persona.departamento }} - {{ persona.provincia }} - {{ persona.distrito }}
							</small>
						}
					</td>
					<td nzAlign="left">
						<nz-space [nzSize]="8">
							<button
								*nzSpaceItem
								nz-tooltip
								nzTooltipTitle="Editar"
								class="edit-btn flex items-center justify-center w-8 h-7"
								[routerLink]="['/admin/personas/update', persona.id_persona]"
							>
								<span nz-icon nzType="edit" nzTheme="fill" class="text-white"></span>
							</button>
							<button
								*nzSpaceItem
								nz-tooltip
								class="delete-btn flex items-center justify-center w-8 h-7"
								nzTooltipTitle="Eliminar"
								(click)="deletePerosna(persona)"
							>
								<span nz-icon nzType="delete" nzTheme="fill" class="text-white"></span>
							</button>
						</nz-space>
					</td>
				</tr>
			}
		</tbody>
	</nz-table>

	<div class="mt-4 text-right text-sm text-gray-600">
		<strong>Total de Marcas: {{ total }}</strong>
	</div>
</div>
